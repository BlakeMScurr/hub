tenets:
  - name: sql-concats
    doc: Find all variable name ending in SQL that contain string concatenations.
    bots:
      codelingo/review:
        comments: SQL query strings shouldnt be concatenated as these are susceptible to SQL injection
    query: |
      import codelingo/ast/php
      php.expr_assign({depth: any}):
        @ review.comment
        php.expr_variable({depth: any}):
          name: /.*SQL*/
        php.expr_binaryop_concat({depth: any})